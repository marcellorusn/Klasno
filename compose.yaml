# Docker Compose configuration for KLASNO App with PWA support
services:
  app:
    build:
      context: .
      dockerfile: .docker/Dockerfile
    container_name: klasno-app
    
    # Port mapping: <host>:<container>
    # Access app at http://localhost:5174 on your machine
    ports:
      - "5174:5174"
    
    # Volume mount for hot-reload development
    # .:/app mounts current directory to /app inside container
    # Changes to files on host are instantly reflected in container
    volumes:
      - .:/app
      # Exclude node_modules from mount to avoid permission issues
      - /app/node_modules
      # Exclude .vite cache to prevent rebuild issues
      - /app/.vite
      # Exclude dist build artifacts
      - /app/dist
    
    # Set working directory
    working_dir: /app
    
    # Override CMD from Dockerfile (optional, but ensures correct port)
    # If removed, uses Dockerfile CMD which is also correct
    command: yarn dev --host 0.0.0.0 --port 5174
    
    # Keep container running even if process exits
    restart: unless-stopped
    
    # Environment variables (optional, for optimization)
    environment:
      - NODE_ENV=development
      # Increase Node.js memory if needed
      # - NODE_OPTIONS=--max-old-space-size=4096

